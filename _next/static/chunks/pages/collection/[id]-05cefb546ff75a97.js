(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[377],{53439:function(e,n,t){let s=t(67294),l=s.forwardRef(function({title:e,titleId:n,...t},l){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:l,"aria-labelledby":n},t),e?s.createElement("title",{id:n},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5"}))});e.exports=l},31215:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/collection/[id]",function(){return t(55211)}])},72141:function(e,n,t){"use strict";t.d(n,{Z:function(){return a}});var s=t(80895),l=t(67294);function a(){return(0,l.useContext)(s.L)}},55211:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return C}});var s=t(85893),l=t(67294),a=t(79286),i=t(89583),r=t(64249),c=t(44718),o=t(54306),d=t(74021),u=t(57906),x=t(53439),m=t.n(x),h=t(49836),g=t(44777),f=t(86501),p=t(85779);function j(){return(0,l.useContext)(p.y)}let b=e=>{let{disentangle:n}=e,{connection:t}=(0,c.R)(),{tokens:x,entangledTokens:p,isFetching:b,entangled:w,disentangled:N}=j(),v=n?p:x,k=(0,o.O)(),[y,C]=(0,l.useState)(!1),[E,_]=(0,l.useState)(!1),[S,L]=(0,l.useState)([]),M=async()=>{if(k&&0!=S.length&&t){C(!0);try{let e=[];for(let s of S){let l=new h.Transaction(await t.getLatestBlockhash()),i=new u.t$(a.T7,k.publicKey,a.Yy,a.bR,500),c=(0,r.Ms)(a.Yy,s.address);if(n)try{let o=(0,r.FK)(c),x=await d.o.fetch(t,o);l.add(i.instruction.disentangle(null==x?void 0:x.originalMint))}catch(m){f.Am.error("Can't disentangle ".concat(s.name))}else{try{await (0,g.ih)(t,c)}catch(p){l.add(i.instruction.initializePair(s.address))}l.add(i.instruction.entangle(s.address)),E&&l.add(i.instruction.burnOriginal(s.mint.address))}l.feePayer=k.publicKey,e.push(l)}if((e=e.filter(e=>(console.log(e.instructions),e.instructions.length>0))).length>0){let j=await k.signAllTransactions(e);await Promise.all(j.map(async e=>await t.confirmTransaction(await t.sendRawTransaction(e.serialize(),{skipPreflight:!0})))),n?N(S):w(S)}L([])}catch(b){console.log(b),f.Am.error("Entanglement failed: ".concat(b))}finally{C(!1)}}};return console.log(S.map(e=>e.address.toString())),(0,s.jsxs)("div",{className:"rounded-xl bg-base-200 m-5 shadow-xl",children:[S.length>0?(0,s.jsxs)("div",{className:"flex flex-col gap-3 bg-base-200 max-w-xl mx-auto rounded-lg p-5 justify-center",children:[(0,s.jsxs)("h4",{className:"text-3xl font-bold text-center",children:[n?"Disentangle":"Entangle"," ",S.length," ","Dippies"]}),(0,s.jsx)("div",{className:"w-32 sm:w-48 mx-auto",children:(0,s.jsx)("div",{className:"stack",children:S.map((e,n)=>{var t;return(0,s.jsx)("img",{className:"w-32 sm:w-48 rounded-md",src:null===(t=e.json)||void 0===t?void 0:t.image})})})}),(0,s.jsxs)("div",{className:"btn btn-lg btn-primary flex flex-row gap-5 ".concat(0!==S.length?"":"btn-disabled"," ").concat(y?"loading btn-disabled":""),onClick:M,children:[n?"Disentangle":"Entangle",(0,s.jsx)("span",{className:"text-xl",children:S.length}),(0,s.jsx)(m(),{className:"w-8 h-8"})]}),n?null:(0,s.jsxs)("label",{className:"label cursor-pointer",children:[(0,s.jsxs)("div",{className:"flex flex-row gap-3",children:[(0,s.jsx)("span",{className:"label-text font-bold",children:"Burn the original"}),(0,s.jsx)("span",{className:"tooltip","data-tip":"Checking this box burns the original token to save some SOL",children:(0,s.jsx)(i.MXt,{className:"my-auto"})})]}),(0,s.jsx)("input",{className:"checkbox",type:"checkbox",checked:E,onChange:()=>_(e=>!e)})]})]}):null,v&&v.length>0?(0,s.jsxs)("div",{className:"flex flex-col p-5 gap-3",children:[(0,s.jsxs)("div",{className:"text-center text-3xl font-bold",children:["Select tokens to ",n?"disentangle":"entangle"]}),S.length>0?(0,s.jsx)("div",{className:"btn btn-primary w-fit m-auto",onClick:()=>L([]),children:"Deselect all tokens"}):(0,s.jsx)("div",{className:"btn btn-primary w-fit m-auto",onClick:()=>L(v),children:"Select all tokens"}),(0,s.jsx)("div",{className:"flex flex-wrap justify-center",children:v.map(e=>{var n;return(0,s.jsxs)("div",{className:"m-2 static flex flex-col w-32 sm:w-48 rounded-lg shadow-xl bg-neutral ".concat(S.includes(e)?"border-2 border-accent":""),onClick:()=>S.includes(e)?L(n=>n.filter(n=>!n.address.equals(e.address))):L(n=>[...n,e]),children:[S.includes(e)?(0,s.jsx)("div",{className:"absolute p-1",children:(0,s.jsx)(i.FJM,{className:"text-accent w-8 h-8"})}):null,(0,s.jsx)("img",{className:"w-56 rounded-t-md",src:null===(n=e.json)||void 0===n?void 0:n.image}),(0,s.jsx)("span",{className:"text-xl font-bold text-center p-3 text-neutral-content",children:e.name})]},e.address.toString())})})]}):(0,s.jsx)(s.Fragment,{children:b?(0,s.jsxs)("div",{className:"text-center text-3xl p-5",children:[(0,s.jsx)("span",{children:"Fetching tokens..."}),(0,s.jsx)("progress",{className:"progress"})]}):(0,s.jsxs)("div",{className:"text-center font-bold text-3xl p-5",children:["No tokens to ",n?"disentangle":"entangle"]})})]})};var w=t(9008),N=t.n(w),v=t(72141),k=t(11163);let y=()=>{let{connection:e}=(0,c.R)(),n=(0,k.useRouter)(),{id:t}=n.query,{setCollections:a}=j(),{collections:i}=(0,v.Z)(),r=null==i?void 0:i.find(e=>e.key===t);return(0,l.useEffect)(()=>{r&&(async()=>{let n=await u.t$.fetcher.entangledCollection(e,r.id);n&&a(n.originalCollectionMint,n.entangledCollectionMint)})()},[r]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(N(),{children:[(0,s.jsxs)("title",{children:["Dippies Club -"," ",r?r.name:"Collection"]}),(0,s.jsx)("meta",{name:"description",content:"A path forward"}),(0,s.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,s.jsxs)("div",{className:"mt-24",children:[(0,s.jsx)(b,{}),(0,s.jsx)(b,{disentangle:!0})]})]})};var C=y},9008:function(e,n,t){e.exports=t(83121)},11163:function(e,n,t){e.exports=t(80880)}},function(e){e.O(0,[445,774,888,179],function(){return e(e.s=31215)}),_N_E=e.O()}]);