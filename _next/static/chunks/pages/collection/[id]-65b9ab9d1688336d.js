(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[377],{53439:function(e,n,t){let s=t(67294),a=s.forwardRef(function({title:e,titleId:n,...t},a){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:a,"aria-labelledby":n},t),e?s.createElement("title",{id:n},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5"}))});e.exports=a},31215:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/collection/[id]",function(){return t(55211)}])},72141:function(e,n,t){"use strict";t.d(n,{Z:function(){return l}});var s=t(80895),a=t(67294);function l(){return(0,a.useContext)(s.L)}},55211:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return E}});var s=t(85893),a=t(67294),l=t(79286),i=t(58918),r=t(49836),c=t(44718),o=t(54306),d=t(29885),u=t(74021),x=t(89583),f=t(53439),m=t.n(f),h=t(62397),g=t(22920),p=t(36454);function w(){return(0,a.useContext)(p.y)}var j=t(48764).Buffer;let b=e=>{let{disentangle:n}=e,{connection:t}=(0,c.R)(),{tokens:f,entangledTokens:p,isFetching:b,fetchTokens:v}=w(),N=n?p:f,y=(0,o.O)(),[k,C]=(0,a.useState)(!1),[E,_]=(0,a.useState)([]),P=async()=>{if(y&&0!=E.length&&t){C(!0);try{let e=[];for(let s of E){let a=new r.Transaction(await t.getLatestBlockhash()),c=new i.t$(s.address,y.publicKey,l.Yy,l.bR,500),[o]=r.PublicKey.findProgramAddressSync([j.from("entanglement-mint"),l.Yy.toBuffer(),s.address.toBuffer()],d.R);if(n){let[x]=r.PublicKey.findProgramAddressSync([j.from(i.Fe),s.address.toBuffer()],d.R),f=await u.o.fetch(t,x);a.add(c.instruction.disentangle(null==f?void 0:f.originalMint))}else{try{await (0,h.ih)(t,o)}catch(m){a.add(c.instruction.initializePair(s.address))}a.add(c.instruction.entangle(s.address))}a.feePayer=y.publicKey,e.push(a)}let p=await y.signAllTransactions(e);await Promise.all(p.map(async e=>await t.confirmTransaction(await t.sendRawTransaction(e.serialize(),{skipPreflight:!0})))),v(),_([])}catch(w){console.log(w),(0,g.Am)("Entanglement failed: ".concat(w))}finally{C(!1)}}};return(0,s.jsxs)("div",{className:"rounded-xl bg-base-200 m-5 shadow-xl",children:[E.length>0?(0,s.jsxs)("div",{className:"flex flex-col gap-3 bg-base-200 max-w-xl mx-auto rounded-lg p-5 justify-center",children:[(0,s.jsxs)("h4",{className:"text-3xl font-bold text-center",children:[n?"Disentangle":"Entangle"," ",E.length," ","Dippies"]}),(0,s.jsx)("div",{className:"w-32 sm:w-48 mx-auto",children:(0,s.jsx)("div",{className:"stack",children:E.map((e,n)=>{var t;return(0,s.jsx)("img",{className:"w-32 sm:w-48 rounded-md",src:null===(t=e.json)||void 0===t?void 0:t.image})})})}),(0,s.jsxs)("div",{className:"btn btn-lg btn-primary flex flex-row gap-5 ".concat(0!==E.length?"":"btn-disabled"," ").concat(k?"loading btn-disabled":""),onClick:P,children:[n?"Disentangle":"Entangle",(0,s.jsx)("span",{className:"text-xl",children:E.length}),(0,s.jsx)(m(),{className:"w-8 h-8"})]})]}):null,N&&N.length>0?(0,s.jsxs)("div",{className:"flex flex-col p-5",children:[(0,s.jsxs)("span",{className:"text-center text-3xl font-bold",children:["Select Dippies to ",n?"disentangle":"entangle"]}),(0,s.jsx)("div",{className:"flex flex-wrap justify-center",children:N.map(e=>{var n;return(0,s.jsxs)("div",{className:"m-2 static flex flex-col w-32 sm:w-48 rounded-lg shadow-xl bg-neutral ".concat(E.includes(e)?"border-2 border-accent":""),onClick:()=>E.includes(e)?_(n=>n.filter(n=>!n.address.equals(e.address))):_(n=>[...n,e]),children:[E.includes(e)?(0,s.jsx)("div",{className:"absolute p-1",children:(0,s.jsx)(x.FJM,{className:"text-accent w-8 h-8"})}):null,(0,s.jsx)("img",{className:"w-56 rounded-t-md",src:null===(n=e.json)||void 0===n?void 0:n.image}),(0,s.jsx)("span",{className:"text-xl font-bold text-center p-3 text-neutral-content",children:e.name})]},e.address.toString())})})]}):(0,s.jsx)(s.Fragment,{children:b?(0,s.jsxs)("div",{className:"text-center text-3xl p-5",children:[(0,s.jsx)("span",{children:"Fetching tokens..."}),(0,s.jsx)("progress",{className:"progress"})]}):(0,s.jsxs)("span",{className:"text-center font-bold text-3xl p-5",children:["No tokens to ",n?"disentangle":"entangle"]})})]})};var v=t(9008),N=t.n(v),y=t(72141),k=t(11163);let C=()=>{let{connection:e}=(0,c.R)(),n=(0,k.useRouter)(),{id:t}=n.query,{setCollections:l}=w(),{collections:r}=(0,y.Z)(),o=null==r?void 0:r.find(e=>e.key===t);return(0,a.useEffect)(()=>{o&&(async()=>{let n=await i.t$.fetcher.entangledCollection(e,o.id);n&&l(n.originalCollectionMint,n.entangledCollectionMint)})()},[o]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(N(),{children:[(0,s.jsxs)("title",{children:["Dippies Club -"," ",o?o.name:"Collection"]}),(0,s.jsx)("meta",{name:"description",content:"A path forward"}),(0,s.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,s.jsxs)("div",{className:"mt-24",children:[(0,s.jsx)(b,{}),(0,s.jsx)(b,{disentangle:!0})]})]})};var E=C},9008:function(e,n,t){e.exports=t(83121)},11163:function(e,n,t){e.exports=t(80880)}},function(e){e.O(0,[445,774,888,179],function(){return e(e.s=31215)}),_N_E=e.O()}]);